<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="./favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Training StyleGAN2 and Applying Latent Space Discovery Techniques on a Novel Gemstone Images Dataset</title>
    <meta name="description" content=""/>
    <meta property="og:title" content="Training StyleGAN2 and Applying Latent Space Discovery Techniques on a Novel Gemstone Images Dataset" />
    <meta property="og:description" content="" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://harryli0088.github.io/CS137-DNN-Project-StyleGAN2-Diamond" />
    <meta property="og:image" content="https://harryli0088.github.io/CS137-DNN-Project-StyleGAN2-Diamond/gemstones_036000.png"/>

		

		

		<link rel="modulepreload" href="/CS137-DNN-Project-StyleGAN2-Diamond/_app/start-94b27585.js">
		<link rel="modulepreload" href="/CS137-DNN-Project-StyleGAN2-Diamond/_app/chunks/vendor-f0c5e220.js">
		<link rel="modulepreload" href="/CS137-DNN-Project-StyleGAN2-Diamond/_app/chunks/paths-28a87002.js">
		<link rel="modulepreload" href="/CS137-DNN-Project-StyleGAN2-Diamond/_app/pages/__layout.svelte-be9c94e5.js">
		<link rel="modulepreload" href="/CS137-DNN-Project-StyleGAN2-Diamond/_app/chunks/Blanchor-75a0ceec.js">
		<link rel="modulepreload" href="/CS137-DNN-Project-StyleGAN2-Diamond/_app/pages/index.svelte-6cf8327a.js">
		<link rel="stylesheet" href="/CS137-DNN-Project-StyleGAN2-Diamond/_app/assets/start-61d1577b.css">
		<link rel="stylesheet" href="/CS137-DNN-Project-StyleGAN2-Diamond/_app/assets/vendor-ec9510ad.css">
		<link rel="stylesheet" href="/CS137-DNN-Project-StyleGAN2-Diamond/_app/assets/pages/__layout.svelte-ad5dbc8d.css">
		<link rel="stylesheet" href="/CS137-DNN-Project-StyleGAN2-Diamond/_app/assets/pages/index.svelte-c6dc5761.css">

		<script type="module">
			import { start } from "/CS137-DNN-Project-StyleGAN2-Diamond/_app/start-94b27585.js";
			start({
				target: document.querySelector("#svelte"),
				paths: {"base":"/CS137-DNN-Project-StyleGAN2-Diamond","assets":""},
				session: {},
				host: location.host,
				route: true,
				spa: false,
				trailing_slash: "never",
				hydrate: {
					status: 200,
					error: null,
					nodes: [
						import("/CS137-DNN-Project-StyleGAN2-Diamond/_app/pages/__layout.svelte-be9c94e5.js"),
						import("/CS137-DNN-Project-StyleGAN2-Diamond/_app/pages/index.svelte-6cf8327a.js")
					],
					page: {
						host: location.host, // TODO this is redundant
						path: "\u002F",
						query: new URLSearchParams(""),
						params: {}
					}
				}
			});
		</script>
	</head>
	<body>
		<div id="svelte">


<main><main><header><div><h1>Training StyleGAN2 and Applying Latent Space Discovery Techniques on a Novel Gemstone Images Dataset</h1>
      <div>Harry X. Li, Marco Pretell</div>
      <br>
      <div style="font-size:2em"><a href="https://github.com/harryli0088/CS137-DNN-Project-StyleGAN2-Diamond" target="_blank" rel="noopener noreferrer"><svg id="" class="icon-button svelte-fa svelte-1cj2gr0" style="height:1em;vertical-align:-.125em;transform-origin:center;overflow:visible;color:white;" viewBox="0 0 496 512" aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg"><g transform="translate(248 256)" transform-origin="124 0"><g transform="translate(0,0) scale(1,1)"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z" fill="currentColor" transform="translate(-248 -256)"></path></g></g></svg></a></div>

      <br>

      <div><img src="gemstones_index-13_degree-10.0.png" alt="example generated gemstone images" class="svelte-1wsp3u5"></div></div></header>

  <section><p>We trained <a href="https://github.com/rosinality/stylegan2-pytorch" target="_blank" rel="noopener noreferrer">StyleGAN2</a> on a novel gemstone images dataset and applied a latent space discovery technique to control for output features. All the images and videos on this page are generated using an AI model.</p>

    <a href="https://tufts.box.com/s/j12sbzunf4absbji9mt8oxeur9oaij2u" target="_blank" rel="noopener noreferrer"><button class="colored" style="background-color:#FF5733">All Output Files <svg id="" class="svelte-fa svelte-1cj2gr0" style="height:1em;vertical-align:-.125em;transform-origin:center;overflow:visible" viewBox="0 0 384 512" aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg"><g transform="translate(192 256)" transform-origin="96 0"><g transform="translate(0,0) scale(1,1)"><path d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm160-14.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z" fill="currentColor" transform="translate(-192 -256)"></path></g></g></svg></button></a>
     

    <a href="https://tufts.box.com/s/ipm16ki7vfk7g0bt4v48mmcbgq0yav4b" target="_blank" rel="noopener noreferrer"><button class="colored" style="background-color:#F39C12">Full Report <svg id="" class="svelte-fa svelte-1cj2gr0" style="height:1em;vertical-align:-.125em;transform-origin:center;overflow:visible" viewBox="0 0 384 512" aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg"><g transform="translate(192 256)" transform-origin="96 0"><g transform="translate(0,0) scale(1,1)"><path d="M181.9 256.1c-5-16-4.9-46.9-2-46.9 8.4 0 7.6 36.9 2 46.9zm-1.7 47.2c-7.7 20.2-17.3 43.3-28.4 62.7 18.3-7 39-17.2 62.9-21.9-12.7-9.6-24.9-23.4-34.5-40.8zM86.1 428.1c0 .8 13.2-5.4 34.9-40.2-6.7 6.3-29.1 24.5-34.9 40.2zM248 160h136v328c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V24C0 10.7 10.7 0 24 0h200v136c0 13.2 10.8 24 24 24zm-8 171.8c-20-12.2-33.3-29-42.7-53.8 4.5-18.5 11.6-46.6 6.2-64.2-4.7-29.4-42.4-26.5-47.8-6.8-5 18.3-.4 44.1 8.1 77-11.6 27.6-28.7 64.6-40.8 85.8-.1 0-.1.1-.2.1-27.1 13.9-73.6 44.5-54.5 68 5.6 6.9 16 10 21.5 10 17.9 0 35.7-18 61.1-61.8 25.8-8.5 54.1-19.1 79-23.2 21.7 11.8 47.1 19.5 64 19.5 29.2 0 31.2-32 19.7-43.4-13.9-13.6-54.3-9.7-73.6-7.2zM377 105L279 7c-4.5-4.5-10.6-7-17-7h-6v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-74.1 255.3c4.1-2.7-2.5-11.9-42.8-9 37.1 15.8 42.8 9 42.8 9z" fill="currentColor" transform="translate(-192 -256)"></path></g></g></svg></button></a>
     

    <a href="https://tufts.box.com/s/lqd4d4vvgmhg7spqkpap1y0izr94p4w9" target="_blank" rel="noopener noreferrer"><button class="colored" style="background-color:#3498DB">Full Presentation <svg id="" class="svelte-fa svelte-1cj2gr0" style="height:1em;vertical-align:-.125em;transform-origin:center;overflow:visible" viewBox="0 0 576 512" aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg"><g transform="translate(288 256)" transform-origin="144 0"><g transform="translate(0,0) scale(1,1)"><path d="M336.2 64H47.8C21.4 64 0 85.4 0 111.8v288.4C0 426.6 21.4 448 47.8 448h288.4c26.4 0 47.8-21.4 47.8-47.8V111.8c0-26.4-21.4-47.8-47.8-47.8zm189.4 37.7L416 177.3v157.4l109.6 75.5c21.2 14.6 50.4-.3 50.4-25.8V127.5c0-25.4-29.1-40.4-50.4-25.8z" fill="currentColor" transform="translate(-288 -256)"></path></g></g></svg></button></a>
     
    
    

    <hr>

    <h2>Can You Tell the Difference?</h2>

    <p>Play a game to see if you can tell the difference between real and generated images!</p>

    <a href="/CS137-DNN-Project-StyleGAN2-Diamond/game"><button class="colored" style="background-color:#F39C12">Play a Game <svg id="" class="svelte-fa svelte-1cj2gr0" style="height:1em;vertical-align:-.125em;transform-origin:center;overflow:visible" viewBox="0 0 640 512" aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg"><g transform="translate(320 256)" transform-origin="160 0"><g transform="translate(0,0) scale(1,1)"><path d="M480.07 96H160a160 160 0 1 0 114.24 272h91.52A160 160 0 1 0 480.07 96zM248 268a12 12 0 0 1-12 12h-52v52a12 12 0 0 1-12 12h-24a12 12 0 0 1-12-12v-52H84a12 12 0 0 1-12-12v-24a12 12 0 0 1 12-12h52v-52a12 12 0 0 1 12-12h24a12 12 0 0 1 12 12v52h52a12 12 0 0 1 12 12zm216 76a40 40 0 1 1 40-40 40 40 0 0 1-40 40zm64-96a40 40 0 1 1 40-40 40 40 0 0 1-40 40z" fill="currentColor" transform="translate(-320 -256)"></path></g></g></svg></button></a>

    <hr>

    <h2>Sample Generated Images</h2>

    <p>These are sample output images from a model trained on a diamonds dataset and an angled gemstones dataset. Each cell represents one image generated from input noise.</p>

    <h3>Diamonds, 27k Training Iterations</h3>
    <div><img src="diamond_027000.png" alt="example generated diamond images" class="svelte-1wsp3u5"></div>

    <br>

    <h3>Gemstones, 36k Training Iterations</h3>
    <div><img src="gemstones_036000.png" alt="example generated gemstone images" class="svelte-1wsp3u5"></div>

    <hr>

    <h2>Controlling Output Features via Latent Space Eignvectors</h2>
    
    <p>We used a <a href="https://arxiv.org/abs/2007.06600" target="_blank" rel="noopener noreferrer">closed-form factorization</a> technique to identify eigenvectors in the latent space that control for output features. Each row (y axis) represents an eigenvector to be manipulated. The first row has the largest eigenvalue, and each subsequent row has smaller eignvalues. Each column (x axis) represents images generated using the same input noise vector. Change in time represents the change in manipulation intensity of the respective eigenvector from highly negative manipulation (early in the video), to no manipulation (middle of video), to highly positive manipulation (end of video). You can see that in the middle of the video when there is no manipulation, all the output images for a single column are the same.</p>

    <p>In most cases, we found that individual eigenvectors controlled multiple output features, making it tricky to explain. If you think you&#39;ve discovered a good explanation for any of the eigenvectors, let us know by opening an issue in our <a href="https://github.com/harryli0088/CS137-DNN-Project-StyleGAN2-Diamond" target="_blank" rel="noopener noreferrer">repository</a>!</p>

    <h3>Diamonds 27k Training Iterations, 10 indices, 15 samples, 10 degrees</h3>

    <p>The 1st eigenvector (row) seems to decide whether the output diamond has a circular vs ovular shape. For example, when the manipulation is highly negative, the output shapes seem to be compact Rounds, Princesses (squares), and Hearts. When the manipulation is highly positive, the shapes are more elongated Ovals, Emeralds (rectangles), and Pears.</p>

    <p>Interestinly, the 2nd eigenvector (row) seems to control for centering and padding. In our dataset, some images needed to be centered and gray-padded into square dimensions. With negative manipulation, all the output images have our centering and padding artifacts. With positive manipulation, none of the images are centered or padded.</p>

    <video width="100%" height="auto" controls style="background-color:gray"><source src="diamond_8-indices_15-samples_10-degrees_027000.mp4" type="video/mp4">
      Your browser does not support the video tag :( but you can view it <a href="https://tufts.box.com/s/srj3pfkonl3x36euxiz4ar4ibfni81li" target="_blank" rel="noopener noreferrer">here</a><track kind="captions"></video>

    <br>

    <h3>Gemstones 36k Training Iterations, 8 indices, 10 samples, 10 degrees</h3>

    <p>The 2nd eigenvector (row) seems to decide whether the output gemstone is green and from a frontal angle (negative manipulation) vs pink and from a sideways angle (positive manipulation).</p>

    <p>The 3rd eigenvector (row) seems to decide whether the output gemstone is yellow (negative manipulation) or blue (positive manipulation).</p>

    <video width="100%" height="auto" controls style="background-color:gray"><source src="gemstones_8-indices_10-samples_10-degrees_036000.mp4" type="video/mp4">
      Your browser does not support the video tag :( but you can view it <a href="https://tufts.box.com/s/srj3pfkonl3x36euxiz4ar4ibfni81li" target="_blank" rel="noopener noreferrer">here</a><track kind="captions"></video></section>
</main></main>

<footer class="svelte-1tumlcc"><p>Built using <a href="https://kit.svelte.dev/" target="_blank" rel="noopener noreferrer">Svelte Kit</a> and <a href="https://www.typescriptlang.org/" target="_blank" rel="noopener noreferrer">TypeScript</a></p>
  <p>Github Repo: <a href="https://github.com/harryli0088/CS137-DNN-Project-StyleGAN2-Diamond" target="_blank" rel="noopener noreferrer">https://github.com/harryli0088/CS137-DNN-Project-StyleGAN2-Diamond</a></p>
  <p>Icons provided by Font Awesome: <a href="https://fontawesome.com/license" target="_blank" rel="noopener noreferrer">https://fontawesome.com/license</a></p>
  <p>Big thank you to <a href="https://github.com/rosinality" target="_blank" rel="noopener noreferrer">rosinality</a> and his <a href="https://github.com/rosinality/stylegan2-pytorch" target="_blank" rel="noopener noreferrer">PyTorch implementation of StyleGAN2</a>!</p>
</footer>



			
		</div>
	</body>
</html>
